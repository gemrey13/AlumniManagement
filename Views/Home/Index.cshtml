@model IEnumerable<AlumniManagement.Entities.Alumnus>
@{
    ViewData["Title"] = "Home Page";
}

@Html.Partial("Partials/AnnouncementItem")
@Html.Partial("Partials/EventItem")

<div class="row justify-content-center">
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">Total Alumni</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <div id="sparklinedash"><canvas width="67" height="30"
                            style="display: inline-block; width: 67px; height: 30px; vertical-align: top;"></canvas>
                    </div>
                </li>
                <li class="ms-auto"><span class="counter text-success total-alumni">659</span></li>
            </ul>
        </div>
    </div>
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">Total Events</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <div id="sparklinedash2"><canvas width="67" height="30"
                            style="display: inline-block; width: 67px; height: 30px; vertical-align: top;"></canvas>
                    </div>
                </li>
                <li class="ms-auto"><span class="counter text-purple total-events">869</span></li>
            </ul>
        </div>
    </div>
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">Total Announcements</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <div id="sparklinedash3"><canvas width="67" height="30"
                            style="display: inline-block; width: 67px; height: 30px; vertical-align: top;"></canvas>
                    </div>
                </li>
                <li class="ms-auto"><span class="counter text-info total-announcements">911</span>
                </li>
            </ul>
        </div>
    </div>
</div>

@* display the employment rate*@
<div class="row justify-content-center">
    
    <h4><b>Employment Rate</b></h4>
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">CCS</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <img src="~/img/ccs_logo.jpg" width="67" class="img-fluid" alt="">
                </li>
                <li class="ms-auto"><span class="counter text-success ccs-employment">659</span></li>
            </ul>
        </div>
    </div>
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">COC</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <img src="~/img/commerce_logo.png" width="67" class="img-fluid" alt="">
                </li>
                <li class="ms-auto"><span class="counter text-purple coc-employment">869</span></li>
            </ul>
        </div>
    </div>
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">CTE</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <img src="~/img/cte_logo.jpg" width="67" class="img-fluid" alt="">
                </li>
                <li class="ms-auto"><span class="counter text-info cte-employment">911</span>
                </li>
            </ul>
        </div>
    </div>
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">CCJE</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <img src="~/img/ccje_logo.jpg" width="67" class="img-fluid" alt="">
                </li>
                <li class="ms-auto"><span class="counter text-info ccje-employment">911</span>
                </li>
            </ul>
        </div>
    </div>
    <div class="col-lg-4 col-md-12">
        <div class="white-box analytics-info">
            <h3 class="box-title">Psychology</h3>
            <ul class="list-inline two-part d-flex align-items-center mb-0">
                <li>
                    <img src="~/img/psych_logo.png" width="67" class="img-fluid" alt="">
                </li>
                <li class="ms-auto"><span class="counter text-info psych-employment">911</span>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12 col-lg-12 col-sm-12">
        <div class="white-box">
            <div class="d-md-flex mb-3">
                <h3 class="box-title mb-0">Newly added Alumni</h3>
            </div>
            <div class="table-responsive">
                <table class="table no-wrap">
                    <thead>
                        <tr>
                            <th class="fw-bold">
                                @Html.DisplayNameFor(model => model.FirstName)
                            </th>
                            <th class="fw-bold">
                                @Html.DisplayNameFor(model => model.LastName)
                            </th>
                            <th class="fw-bold">
                                @Html.DisplayNameFor(model => model.CourseGraduated)
                            </th>
                            <th class="fw-bold">
                                @Html.DisplayNameFor(model => model.YearGraduated)
                            </th>
                            <th class="fw-bold">
                                @Html.DisplayNameFor(model => model.WorkingStatus)
                            </th>
                            <th class="fw-bold">
                                @Html.DisplayNameFor(model => model.CurrentWork)
                            </th>
                            <th class="fw-bold">
                                Action
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach(var item in Model){
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => item.FirstName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.LastName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.CourseGraduated)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.YearGraduated)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.WorkingStatus)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.CurrentWork)
                                </td>
                                <td>
                                    <a asp-action="Edit" asp-controller="Alumni" asp-route-id="@item.Id">Edit</a> |
                                    <a asp-action="Details" asp-controller="Alumni" asp-route-id="@item.Id">Details</a> |
                                    <a asp-action="Delete" asp-controller="Alumni" asp-route-id="@item.Id">Delete</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- .col -->
    <div class="col-md-12 col-lg-8 col-sm-12">
        <div class="card white-box p-0">
            <div class="card-body">
                <h3 class="box-title mb-0">Announcements</h3>
            </div>
            <div class="comment-widgets">
            </div>
        </div>
    </div>
    <div class="col-lg-4 col-md-12 col-sm-12">
        <div class="card white-box p-0">
            <div class="card-heading">
                <h3 class="box-title mb-0">Upcoming Events</h3>
            </div>
            <div class="card-body">
                <ul class="chatonline">
                </ul>
            </div>
        </div>
    </div>
    <!-- /.col -->
</div>
<footer class="footer text-center"> 2021 © Alumni Management brought to you by <a
    href="https://www.wrappixel.com/">wrappixel.com</a>
</footer>  
<script src="~/lib/jquery/dist/jquery.min.js"></script>

<script>
    $(()=>{

        // Announcements
        const GetAnnouncements = () =>{
            $.ajax({
                method:"GET",
                url:"/api/client/getannouncements",
                success:res=>{
                    console.log(res)
                    const container = $(".comment-widgets")
                    const announcementItemTemp = $("#student-item-temp").html();
                    res.slice(0,3).forEach(item => {
                        const announcementItem = $(announcementItemTemp).clone()
                        announcementItem.find("div>h5").text(`${item.announcementTitle}`)
                        announcementItem.find("div>.desc").text(`${item.announcementDescription}`)
                        container.append(announcementItem)
                    })
                }
            })
        }

        // Get at least 5 events
        const GetEvents = () => {
            $.ajax({
                method:"GET",
                url:"/api/client/getevents",
                success:res=>{
                    const container = $(".chatonline")
                    const eventItemTemp = $("#event-item-temp").html()
                    console.log(res)
                    res.slice(0,5).forEach(item=>{
                        const eventItem = $(eventItemTemp).clone();
                        eventItem.find("h4").text(`${item.eventName}`)
                        eventItem.find(".event-date").text(`${item.eventDate}`)
                        container.append(eventItem)
                        console.log(item.eventName)
                    })
                },
                error:err=>{
                    console.error(err)
                }
            })
        }

        // Total alumni
        const GetTotalAlumni = () => {
            $.ajax({
                method:"GET",
                url:"/api/client/gettotalentityitems",
                success:res=>{
                    $(".total-alumni").text(res.TotalAlumni)
                    $(".total-events").text(res.TotalEvents)
                    $(".total-announcements").text(res.TotalAnnouncements)
                    console.log(res)
                }
            })
        }

        // Get employment rate
        const GetEmploymentRate = () => {
            $.ajax({
                method:"GET",
                url:"/api/client/getemploymentrate",
                success:res=>{
                    const ccsEmploymentRate = `${(res.ccs.employed/res.ccs.population)*100}%`
                    const ccjeEmploymentRate = `${(res.ccje.employed/res.ccje.population)*100}%`
                    const cteEmploymentRate = `${(res.cte.employed/res.cte.population)*100}%`
                    const psychEmploymentRate = `${(res.psych.employed/res.psych.population)*100}%`
                    const cocEmploymentRate = `${(res.coc.employed/res.coc.population)*100}%`

                    $(".ccs-employment").text(ccsEmploymentRate)
                    $(".cte-employment").text(cteEmploymentRate)
                    $(".ccje-employment").text(ccjeEmploymentRate)
                    $(".psych-employment").text(psychEmploymentRate)
                    $(".coc-employment").text(cocEmploymentRate)

                    console.log(ccsEmploymentRate)
                },
                error:err=>{
                    console.log(err)
                }
            })
        }

        GetEmploymentRate()
        GetTotalAlumni()
        GetAnnouncements()
        GetEvents()
    })
</script>